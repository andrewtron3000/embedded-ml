let
    import "std.uh"
    import "list.uh"
    import "string.uh"
    import "int.uh"
    import "descriptorio.uh"
    import "socket.uh"

    fun udp-client () =
        let
            val s = socket-open-udp ()
            val () = socket-connect (s, "192.168.1.5", 51423)
        in
            ( descriptor-write (s, "hi from udp land") ;
              socket-close s )
        end

    fun tcp-client () =
        let 
            val s = socket-open-tcp ()
            val () = socket-connect (s, "127.0.0.1", 40004)
                             
            fun ploop i =
                let
                    val b = descriptor-bytes-avail s
                in 
                    if b > 0 
                    then print [<[descriptor-read (s, b)]>\n]
                    else ploop (i + 1)
                end
        in
            ( ploop 1 ;
              socket-close s )
        end

    fun tcp-server () = 
        let
            val s = socket-open-tcp ()
            val () = socket-bind (s, 40005)
            val () = socket-listen (s, 1)
            val s2 = socket-accept s
        in
            ( descriptor-write (s2, "greetings from FP land.  I'm glad to see you.") ;
              socket-close s ;
              socket-close s2 )
        end

in
    print [ip address of google is: [socket-gethostbyname "www.google.com"]\n]
    (* udp-client () *)
end
